<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Presentation Workbook (Legacy Version)</title>
  <link rel="icon" href="favicon.png" type="image/png">
  <link rel="apple-touch-icon" href="favicon.png">
  <style>
    /* Base Styles for IE compatibility */
    * {
      box-sizing: border-box;
    }

    body {
      font-family: "Meiryo", "MS PGothic", "Noto Sans JP", sans-serif;
      background-color: #f1f5f9;
      color: #1e293b;
      margin: 0;
      padding: 0;
      height: 100vh;
      overflow: hidden;
    }

    /* Utiltity for IE Flex */
    .flex {
      display: flex;
    }

    /* IE11 Flexbox support */
    @media all and (-ms-high-contrast:none) {
      .flex {
        display: -ms-flexbox;
        display: flex;
      }

      #app-view {
        display: -ms-flexbox;
        display: flex;
      }
    }

    /* Portal View */
    #portal-view {
      padding: 60px 20px;
      height: 100vh;
      overflow-y: auto;
      text-align: center;
    }

    .portal-title {
      font-size: 36px;
      font-weight: bold;
      margin-bottom: 15px;
      color: #0f172a;
    }

    .portal-sub {
      color: #64748b;
      margin-bottom: 50px;
    }

    .portal-cards {
      max-width: 900px;
      margin: 0 auto;
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      gap: 20px;
    }

    .portal-card {
      background: white;
      border: 1px solid #e2e8f0;
      border-radius: 16px;
      padding: 30px;
      width: 48%;
      text-align: left;
      cursor: pointer;
      color: inherit;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      transition: all 0.2s;
    }

    .portal-card.full {
      width: 100%;
      text-align: center;
      border-width: 2px;
    }

    .portal-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    }

    .portal-card.model {
      border-color: #fde68a;
    }

    .portal-card.model:hover {
      border-color: #f59e0b;
      background: #fffbeb;
    }

    .portal-card.case {
      border-color: #e2e8f0;
    }

    .portal-card.case:hover {
      border-color: #3b82f6;
    }

    .portal-card.daily {
      border-color: #e2e8f0;
    }

    .portal-card.daily:hover {
      border-color: #6366f1;
    }

    .card-badge {
      display: inline-block;
      padding: 6px 12px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: bold;
      color: white;
      margin-bottom: 15px;
    }

    .model .card-badge {
      color: #d97706;
      background: transparent;
      padding: 0;
      margin-bottom: 10px;
    }

    .case .card-badge {
      background: #0f172a;
    }

    .daily .card-badge {
      background: #312e81;
    }

    /* App View */
    #app-view {
      display: none;
      height: 100vh;
      flex-direction: column;
    }

    .header {
      background-color: #ffffff;
      border-bottom: 1px solid #cbd5e1;
      padding: 12px 24px;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
      flex-shrink: 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .header-left {
      display: flex;
      align-items: center;
    }

    .home-btn {
      background: none;
      border: none;
      color: #64748b;
      font-weight: bold;
      font-size: 14px;
      cursor: pointer;
      margin-right: 20px;
      padding: 5px;
    }

    .home-btn:hover {
      color: #0f172a;
    }

    .theme-badge {
      padding: 8px 12px;
      border-radius: 8px;
      color: white;
      font-weight: bold;
      margin-right: 15px;
      font-size: 18px;
    }

    .main-content {
      flex: 1;
      display: flex;
      flex-direction: row;
      padding: 16px;
      gap: 16px;
      overflow: hidden;
      max-width: 1536px;
      margin: 0 auto;
      width: 100%;
    }

    .pane {
      flex: 1;
      display: flex;
      flex-direction: column;
      background: white;
      border: 1px solid #e2e8f0;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .pane-left {
      overflow-y: auto;
      padding: 24px;
      border: none;
      box-shadow: none;
      background: transparent;
    }

    .pane-right {
      display: flex;
      flex-direction: column;
    }

    .step-header-card {
      background: white;
      border: 1px solid #e2e8f0;
      padding: 24px;
      border-radius: 12px;
      margin-bottom: 16px;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
      flex-shrink: 0;
    }

    .step-header-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .step-label {
      font-size: 10px;
      font-weight: bold;
      padding: 4px 8px;
      border-radius: 4px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .step-time {
      font-size: 12px;
      color: #94a3b8;
      font-family: monospace;
    }

    .step-title {
      font-size: 24px;
      font-weight: bold;
      margin: 0 0 8px 0;
    }

    .step-rule {
      font-size: 14px;
      color: #475569;
      line-height: 1.6;
    }

    .example-box {
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 20px;
      border: 1px solid transparent;
      font-size: 14px;
      display: flex;
      flex-direction: column;
      flex: 1;
    }

    .example-val {
      background: white;
      padding: 8px 16px;
      border-left: 4px solid;
      margin-bottom: 16px;
      font-style: italic;
      border-radius: 4px;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
      color: #0f172a;
      line-height: 1.6;
    }

    .tips-box {
      font-size: 14px;
      margin-top: auto;
    }

    .tip-item {
      margin-bottom: 12px;
      display: flex;
      line-height: 1.5;
      font-weight: 500;
    }

    .nav-dots {
      display: flex;
      justify-content: center;
      gap: 4px;
    }

    .dot {
      width: 32px;
      height: 32px;
      border: 2px solid #e2e8f0;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: bold;
      color: #94a3b8;
      cursor: pointer;
      background: white;
      transition: all 0.2s;
    }

    textarea {
      flex: 1;
      width: 100%;
      padding: 24px;
      border: none;
      font-size: 16px;
      line-height: 1.6;
      resize: none;
      font-family: inherit;
      color: #1e293b;
    }

    textarea:focus {
      outline: none;
    }

    .right-header {
      padding: 16px 24px;
      font-weight: bold;
      font-size: 12px;
      text-transform: uppercase;
      border-bottom: 1px solid #e2e8f0;
      letter-spacing: 1px;
    }

    .right-footer {
      padding: 16px 24px;
      background: #f8fafc;
      border-top: 1px solid #f1f5f9;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .btn {
      padding: 8px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      font-size: 14px;
      border: none;
      color: white;
      display: inline-flex;
      align-items: center;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
      text-decoration: none;
    }

    .btn-prev {
      background: transparent;
      color: #94a3b8;
      padding: 8px 0;
      box-shadow: none;
    }

    .btn-prev:hover {
      color: #0f172a;
    }

    .btn-prev:disabled {
      opacity: 0.3;
      cursor: default;
    }

    .btn-next {
      padding: 8px 24px;
    }

    /* Theming - Case (Blue) */
    .theme-case .header-left .theme-badge {
      background: #0f172a;
    }

    .theme-case .step-label {
      background: #dbeafe;
      color: #1d4ed8;
    }

    .theme-case .example-box {
      background: #fffbeb;
      border-color: #fde68a;
    }

    .theme-case .example-box h3 {
      color: #92400e;
    }

    .theme-case .example-val {
      border-color: #fcd34d;
    }

    .theme-case .tips-box h4 {
      border-top: 2px solid #fcd34d;
      color: #78350f;
      padding-top: 16px;
    }

    .theme-case .right-header {
      background: #eff6ff;
      color: #1e40af;
    }

    .theme-case .dot.active {
      border-color: #2563eb;
      color: #2563eb;
    }

    .theme-case .btn-next {
      background: #2563eb;
    }

    .theme-case .btn-next:hover {
      background: #1d4ed8;
    }

    .theme-case .tip-item span {
      color: #2563eb;
      margin-right: 8px;
      font-size: 16px;
    }

    /* Theming - Daily (Indigo) */
    .theme-daily .header-left .theme-badge {
      background: #312e81;
    }

    .theme-daily .step-label {
      background: #e0e7ff;
      color: #4f46e5;
    }

    .theme-daily .example-box {
      background: rgba(238, 242, 255, 0.5);
      border-color: #e0e7ff;
    }

    .theme-daily .example-box h3 {
      color: #3730a3;
    }

    .theme-daily .example-val {
      border-color: #a5b4fc;
    }

    .theme-daily .tips-box h4 {
      border-top: 1px solid #e0e7ff;
      color: #64748b;
      padding-top: 16px;
    }

    .theme-daily .right-header {
      background: #eef2ff;
      color: #3730a3;
    }

    .theme-daily .dot.active {
      border-color: #4f46e5;
      color: #4f46e5;
    }

    .theme-daily .btn-next {
      background: #4338ca;
    }

    .theme-daily .btn-next:hover {
      background: #3730a3;
    }

    .theme-daily .tip-item span {
      color: #4f46e5;
      margin-right: 8px;
      font-size: 16px;
    }

    /* Theming - Model (Amber) */
    .theme-model .header-left .theme-badge {
      background: transparent;
      color: #b45309;
      padding: 4px 8px;
      font-size: 12px;
      background: #fef3c7;
    }

    .warning-ie {
      background-color: #fee2e2;
      border: 1px solid #f87171;
      color: #991b1b;
      padding: 10px;
      font-size: 12px;
      border-radius: 4px;
      text-align: center;
      margin-bottom: 20px;
      margin-top: -20px;
    }
  </style>
</head>

<body>

  <div id="portal-view">
    <div class="warning-ie"><strong>æ³¨æ„:</strong> ã“ã®ãƒšãƒ¼ã‚¸ã¯IEäº’æ›ãƒ¢ãƒ¼ãƒ‰ã‚’å«ã‚€ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ç’°å¢ƒå‘ã‘ã§ã™ã€‚AIæ·»å‰Šã¯åˆ©ç”¨ã§ãã¾ã›ã‚“ã€‚</div>
    <div class="portal-title">Presentation Workbook</div>
    <div class="portal-sub">ç›®çš„ã«åˆã‚ã›ã¦ãƒ¯ãƒ¼ã‚¯ãƒ–ãƒƒã‚¯ã‚’é¸æŠã—ã¦ãã ã•ã„</div>

    <div class="portal-cards">
      <div class="portal-card full model" onclick="startApp('model')">
        <div class="card-badge">ã¾ãšã¯ã€Œå®Œæˆå½¢ã®ãŠæ‰‹æœ¬ã€ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹</div>
        <p style="color: #64748b; font-size: 14px;">ç†æƒ³çš„ãªãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³æ§‹æˆã‚’ã€å®Ÿéš›ã®ç—‡ä¾‹ï¼ˆ77æ­³ç”·æ€§ãƒ»å‘¼å¸å›°é›£ï¼‰ã§ç¢ºèªã§ãã¾ã™</p>
      </div>

      <div class="portal-card case" onclick="startApp('case')">
        <div class="card-badge">H&P</div>
        <h2 style="font-size: 24px; font-weight: bold; margin: 0 0 10px 0;">ç—‡ä¾‹ãƒ—ãƒ¬ã‚¼ãƒ³</h2>
        <span
          style="font-size: 12px; font-weight: bold; background: #dbeafe; color: #1d4ed8; padding: 4px 8px; border-radius: 4px;">åˆè¨ºãƒ»å…¥é™¢æ™‚</span>
        <p style="color: #475569; font-size: 15px; margin-top: 15px; line-height: 1.6;">
          è©³ç´°ãªç—…æ­´è´å–ã‹ã‚‰ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆã¾ã§ã€‚è«–ç†çš„ãªãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³æ§‹æˆã‚’å­¦ã¶ãŸã‚ã®ãƒ•ãƒ«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã€‚</p>
      </div>

      <div class="portal-card daily" onclick="startApp('daily')">
        <div class="card-badge">P-A/P</div>
        <h2 style="font-size: 24px; font-weight: bold; margin: 0 0 10px 0;">ãƒ—ãƒ­ãƒ–ãƒ¬ãƒ åˆ¥ãƒ‡ã‚¤ãƒªãƒ¼</h2>
        <span
          style="font-size: 12px; font-weight: bold; background: #e0e7ff; color: #4338ca; padding: 4px 8px; border-radius: 4px;">å›è¨ºãƒ»çµŒéå ±å‘Š</span>
        <p style="color: #475569; font-size: 15px; margin-top: 15px; line-height: 1.6;">
          æ¯æ—¥ã®å›è¨ºã«ç‰¹åŒ–ã—ãŸãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã€‚å…¨ä½“åƒã®å¾Œã«ã€ãƒ—ãƒ­ãƒ–ãƒ¬ãƒ æ¯ã®ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆã¨ãƒ—ãƒ©ãƒ³ï¼ˆA&Pï¼‰ã‚’æç¤ºã—ã¾ã™ã€‚</p>
      </div>
    </div>
  </div>

  <div id="app-view">
    <div class="header">
      <div class="header-left">
        <button class="home-btn" onclick="showPortal()">â† <span style="text-decoration: underline;">Home</span></button>
        <div class="theme-badge" id="app-badge">H&P</div>
        <div>
          <div style="font-weight:bold; font-size:18px;" id="app-title">ç—‡ä¾‹ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ»ãƒ¯ãƒ¼ã‚¯ãƒ–ãƒƒã‚¯</div>
          <div style="font-size:10px; color:#64748b; font-weight: bold; text-transform: uppercase;">å…¨ã‚¹ãƒ†ãƒƒãƒ—çµ±åˆãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½æ­è¼‰
          </div>
        </div>
      </div>
      <div class="nav-dots" id="nav-dots"></div>
      <div style="display: flex; align-items: center; gap: 10px;">
        <button class="btn btn-next" id="header-btn-download" style="padding: 8px 16px; font-size: 14px;"
          onclick="downloadAll()">ğŸ’¾ å…¨åŸç¨¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
      </div>
    </div>

    <div class="main-content">
      <div class="pane pane-left">
        <div class="step-header-card">
          <div class="step-header-top">
            <span id="step-label" class="step-label">Step 1</span>
            <span id="step-time" class="step-time"></span>
          </div>
          <h2 id="step-title" class="step-title"></h2>
          <div id="step-rule" class="step-rule"></div>
        </div>

        <div class="example-box" id="example-container">
          <h3
            style="font-size: 12px; font-weight: bold; margin:0 0 10px 0; text-transform: uppercase; display: flex; align-items: center; gap: 8px;">
            <span
              style="width: 8px; height: 8px; border-radius: 50%; background: #f59e0b; display: inline-block;"></span>
            ãŠæ‰‹æœ¬
          </h3>
          <div id="step-example" class="example-val"></div>

          <div class="tips-box" id="tips-container">
            <h4
              style="font-size: 12px; font-weight: bold; margin:0 0 15px 0; text-transform: uppercase; display: flex; align-items: center; gap: 8px;">
              <span style="font-size: 16px;">ğŸ’¡</span> Clinical Tips
            </h4>
            <div id="step-tips"></div>
          </div>
        </div>

        <div id="full-model-view" style="display:none;"></div>
      </div>

      <div class="pane pane-right" id="input-card">
        <div class="right-header" id="right-header-text">Your Draft</div>
        <textarea id="draft-input" onkeyup="saveDraft()" placeholder="ãŠæ‰‹æœ¬ã‚’å‚è€ƒã«ã€è‡ªåˆ†ã®æ‹…å½“ç—‡ä¾‹ã«ã¤ã„ã¦æ›¸ãè¾¼ã‚“ã§ãã ã•ã„..."></textarea>

        <div class="right-footer">
          <button class="btn btn-prev" id="btn-prev" onclick="prevStep()">â† PREV</button>
          <span style="font-size:10px; color:#94a3b8; font-family: monospace; letter-spacing: 1px;" id="char-count">0
            CHARS</span>
          <button class="btn btn-next" id="btn-next" onclick="nextStep()">NEXT â†’</button>
        </div>
      </div>
    </div>
  </div>

  <script type="text/javascript">
    // IE11 Content Data
    var datasets = {
      model: [
        { label: "Step 1", title: "Opening Statement", time: "", rule: "å¹´é½¢ã€æ€§åˆ¥ã€æœ€é‡è¦æ—¢å¾€ãƒ»ä½µå­˜ç—‡ã€ä¸»è¨´ã‚’1æ–‡ã§ã€‚", example: "ã€Œ2å‹ç³–å°¿ç—…ã®æ—¢å¾€ãŒã‚ã‚Šã€å–«ç…™æ­´ã‚’æœ‰ã™ã‚‹77æ­³ç”·æ€§ã€‚3æ—¥å‰ã‹ã‚‰ã®æ¹¿æ€§å’³å—½ã¨å‘¼å¸å›°é›£ã‚’ä¸»è¨´ã«æ¥é™¢ã•ã‚Œã¾ã—ãŸã€‚ã€", tips: ["è´è¡†ãŒç¬æ™‚ã«è‡¨åºŠçš„ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æ§‹ç¯‰ã§ãã‚‹ã“ã¨ãŒç›®æ¨™ã€‚"], key: "model_1" },
        { label: "Step 2", title: "ç¾ç—…æ­´ (HPI)", time: "", rule: "å—è¨ºã¾ã§ã®çµŒéã‚’ã€ç›¸å¯¾æ™‚é–“ã€ã§è¨˜è¿°ã€‚ç—‡çŠ¶ã®æ€§çŠ¶(OPQRST)ã«åŠ ãˆã€é‡è¦ãªé™°æ€§æ‰€è¦‹ã‚‚ã€‚", example: "ã€Œ3æ—¥å‰ã‚ˆã‚Šæ¹¿æ€§å’³å—½ãŒå‡ºç¾ã—ã€2æ—¥å‰ã‚ˆã‚ŠåŠ´ä½œæ™‚å‘¼å¸å›°é›£ã‚’èªã‚ã¾ã—ãŸã€‚æ˜¨æ—¥ã‚ˆã‚Šç™ºç†±ã€é£Ÿæ€ä¸æŒ¯ã€ä½“å‹•å›°é›£ã¨ãªã‚Šå—è¨ºã€‚èµ·åå‘¼å¸ã€å†·æ±—ã€ä¸‹è‚¢æµ®è…«ãªã©ã¯èªã‚ã¾ã›ã‚“ã€‚ç³–å°¿ç—…ã®è‡ªå·±ç®¡ç†ã¯è‰¯å¥½ã§ã—ãŸã€‚ã€", tips: ["é£Ÿæ€ä¸æŒ¯ãƒ»ä½“å‹•å›°é›£ã®æç¤ºã¯ã€é‡ç—‡åº¦ãƒ»å…¥é™¢é©å¿œã€ã€‚"], key: "model_2" },
        { label: "Step 3-4", title: "æ—¢å¾€æ­´ãƒ»ä½µå­˜ç—‡ & ç”Ÿæ´»æ­´", time: "", rule: "é‘‘åˆ¥ã«é–¢ä¿‚ã™ã‚‹ã‚‚ã®ã‚’å„ªå…ˆã€‚å–«ç…™æ­´ã€ç’°å¢ƒãªã©ã€‚", example: "ã€Œä½µå­˜ç—‡ã«2å‹ç³–å°¿ç—…ï¼ˆç½¹ç—…æœŸé–“10å¹´ï¼‰ã€é«˜è¡€åœ§ãŒã‚ã‚Šã¾ã™ã€‚å†…æœã¯ãƒ¡ãƒˆãƒ›ãƒ«ãƒŸãƒ³ã€ãƒ€ãƒ‘ã‚°ãƒªãƒ•ãƒ­ã‚¸ãƒ³ã€ã‚¢ãƒ ãƒ­ã‚¸ãƒ”ãƒ³ã€‚è–¬å‰¤ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚\n\nå–«ç…™æ­´ã¯1æ—¥20æœ¬Ã—55å¹´ã€ç¾å–«ç…™è€…ã€‚è·æ­´ã¯äº‹å‹™è·ã€‚ç²‰å¡µæš´éœ²æ­´ã‚„é³¥é¡ã®é£¼è‚²æ­´ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã€", tips: ["è–¬å‰¤æ­´ã¯æ€¥æ€§æœŸã®ç®¡ç†ï¼ˆä¸­æ­¢æ¤œè¨ãªã©ï¼‰ã«ç›´çµã—ã¾ã™ã€‚"], key: "model_3" },
        { label: "Step 5-6", title: "èº«ä½“æ‰€è¦‹ & æ¤œæŸ»æ‰€è¦‹", time: "", rule: "ãƒã‚¤ã‚¿ãƒ«ã€è‚ºéŸ³ã€Xç·šãƒ»CTãƒ»è¡€æ¶²æ¤œæŸ»çµæœã€‚", example: "ã€ŒBP 140/85, HR 95, BT 38.2, RR 24, SpO2 88%(RA)ã€‚è»½åº¦è‹¦æ‚¶æ§˜ã€‚ä¸¡è‚ºé‡ã«wheezesã‚’è´å–ã€‚JVPæ€’å¼µãªã—ã€ä¸‹è‚¢æµ®è…«ãªã—ã€‚\n\nXç·šã§éè†¨å¼µã‚’èªã‚ã¾ã™ãŒæµ¸æ½¤å½±ãªã—ã€‚CTã§æ°—è…«æ€§å¤‰åŒ–ã¨æ°—ç®¡æ”¯å£è‚¥åšã‚’èªã‚ã¾ã™ã€‚PaO2ä½ä¸‹ã€PaCO2 48mmHgã€WBC11000ã€CRPã¯8ã¨ä¸Šæ˜‡ã€‚D-dimerãŠã‚ˆã³BNPã¯æ­£å¸¸ç¯„å›²å†…ã§ã™ã€‚ã€", tips: ["é™¤å¤–ã™ã¹ãç–¾æ‚£ï¼ˆå¿ƒä¸å…¨ãªã©ï¼‰ã‚’å¦å®šã™ã‚‹æ‰€è¦‹ã‚’æç¤ºã€‚"], key: "model_4" },
        { label: "Step 7", title: "ãƒ—ãƒ­ãƒ–ãƒ¬ãƒ ãƒªã‚¹ãƒˆ", time: "", rule: "ç—‡å€™åã§å„ªå…ˆé †ä½ã‚’ã¤ã‘ã¦è¨˜è¼‰ã€‚", example: "#1. wheezesã‚’ä¼´ã†IIå‹æ€¥æ€§å‘¼å¸ä¸å…¨\n#2. 2å‹ç³–å°¿ç—…\n#3. å–«ç…™æ­´", tips: ["æœªè¨ºæ–­ã®æ®µéšã§ç¢ºå®šè¨ºæ–­åã‚’æ›¸ã‹ãªã„ã“ã¨ã€‚"], key: "model_5" },
        { label: "Step 8", title: "ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆ", time: "", rule: "Summary Statementã‹ã‚‰é–‹å§‹ã€‚æœ€ã‚‚å¯èƒ½æ€§ã®é«˜ã„è¨ºæ–­ã®æ ¹æ‹ ã¨é‘‘åˆ¥ã€‚", example: "ã€Œå–«ç…™æ­´ã€æ°—è…«æ€§å¤‰åŒ–ã€wheezesã‹ã‚‰ã€èƒŒæ™¯ã«COPDãŒå­˜åœ¨ã—ã€æ„ŸæŸ“ã«ã‚ˆã‚‹æ€¥æ€§å¢—æ‚ªï¼ˆAE-COPDï¼‰ã‚’ç¬¬ä¸€ã«è€ƒãˆã¾ã™ã€‚å¿ƒä¸å…¨ã‚„è‚ºå¡æ “ç—‡ã¯å¦å®šçš„ã§ã™ã€‚#2 ã«ã¤ã„ã¦ã¯ã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰ä½¿ç”¨ã«ã‚ˆã‚‹é«˜è¡€ç³–å¢—æ‚ªãƒªã‚¹ã‚¯ã‚’è€ƒæ…®ã—ã¾ã™ã€‚ã€", tips: ["è‡¨åºŠæ¨è«–ã‚’è«–ç†çš„ã«èª¬æ˜ã™ã‚‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã€‚"], key: "model_6" },
        { label: "Step 9", title: "ãƒ—ãƒ©ãƒ³", time: "", rule: "è¨ºæ–­ãƒ»æ²»ç™‚ãƒ»æ•™è‚²ãƒ—ãƒ©ãƒ³ã‚’å…·ä½“çš„ã«ã€‚", example: "ã€ŒSpO2 88-92%ç›®æ¨™ã§é…¸ç´ æŠ•ä¸ã€‚å–€ç—°æ¤œæŸ»æå‡ºå¾Œã«ABCç™‚æ³•ï¼ˆæŠ—èŒè–¬ã¯ã‚»ãƒ•ãƒˆãƒªã‚¢ã‚­ã‚½ãƒ³2g/dayãƒ»SAå¸å…¥ãƒ»ã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰ã¯ã‚½ãƒ«ãƒ»ãƒ¡ãƒ‰ãƒ­ãƒ¼ãƒ«40mgx3/dayï¼‰é–‹å§‹ã—ç—…æ…‹ãŒå®‰å®šã™ã‚Œã°LABA/LAMAå¸å…¥è–¬ã®å°å…¥ã‚’æ¤œè¨ã—ã¾ã™ã€‚\n\n#2 ã¯ãƒ¡ãƒˆãƒ›ãƒ«ãƒŸãƒ³ãƒ»ãƒ€ãƒ‘ã‚°ãƒªãƒ•ãƒ­ã‚¸ãƒ³ã‚’ä¸­æ­¢ã—ã€ã‚¹ãƒ©ã‚¤ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ã‚±ãƒ¼ãƒ«å¯¾å¿œã¨ã—ã€çµŒå£æ‘‚å–ãŒå®‰å®šã™ã‚Œã°çµŒå£è–¬ã«å¤‰æ›´äºˆå®šã€‚ç¦ç…™æŒ‡å°ã¨é€€é™¢å‰ã«å¿…è¦ãªãƒ¯ã‚¯ãƒãƒ³æ¥ç¨®ã«ã¤ã„ã¦èª¬æ˜ã‚’è¡Œã„ã¾ã™ã€‚ã€", tips: ["æ²»ç™‚ã ã‘ã§ãªãã€äºˆé˜²çš„ä»‹å…¥ã‚‚å«ã‚ã‚‹ã®ãŒãƒã‚¤ãƒ³ãƒˆã€‚"], key: "model_7" }
      ],
      case: [
        {
          label: "Step 1", title: "Opening Statement", time: "30s",
          rule: "å¹´é½¢ã€æ€§åˆ¥ã€æœ€é‡è¦æ—¢å¾€ãƒ»ä½µå­˜ç—‡ï¼ˆä»Šå›ã®å•é¡Œã«é–¢é€£ã™ã‚‹ã‚‚ã®ï¼‰ã€ä¸»è¨´ã‚’1æ–‡ã§ã€‚è´è¡†ãŒç¬æ™‚ã«è‡¨åºŠçš„ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æ§‹ç¯‰ã§ãã‚‹ã“ã¨ãŒç›®æ¨™ã€‚",
          example: "ã€Œ2å‹ç³–å°¿ç—…ã®æ—¢å¾€ãŒã‚ã‚Šã€å–«ç…™æ­´ã‚’æœ‰ã™ã‚‹77æ­³ç”·æ€§ã€‚3æ—¥å‰ã‹ã‚‰ã®æ¹¿æ€§å’³å—½ã¨å‘¼å¸å›°é›£ã‚’ä¸»è¨´ã«æ¥é™¢ã•ã‚Œã¾ã—ãŸã€‚ã€",
          tips: ["ä½µå­˜ç—‡ã¨ã—ã¦ç³–å°¿ç—…ãŒã‚ã‚‹å ´åˆã€æ„ŸæŸ“ç—‡ã¸ã®æ„Ÿå—æ€§ã‚„ã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰ä½¿ç”¨ã«ã‚ˆã‚‹é«˜è¡€ç³–ã‚’ç¤ºå”†ã™ã‚‹ãŸã‚ã€Openingã§æç¤ºã™ã¹ãã§ã™ã€‚", "åå‰ã¯ä¸è¦ã€‚åŒ»å­¦çš„ãªãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿æç¤ºã€‚"],
          key: "final_workbook_step_1"
        },
        {
          label: "Step 2", title: "ç¾ç—…æ­´ (HPI)", time: "2:30",
          rule: "å—è¨ºã¾ã§ã®çµŒéã‚’ã€ç›¸å¯¾æ™‚é–“ï¼ˆã€œæ—¥å‰ï¼‰ã€ã§è¨˜è¿°ã™ã‚‹ã€‚ç—‡çŠ¶ã®æ€§çŠ¶(OPQRST)ã«åŠ ãˆã€èµ·åå‘¼å¸ãªã©ã®é‡è¦ãªé™°æ€§æ‰€è¦‹ã‚’é…ç½®ã™ã‚‹ã€‚",
          example: "ã€Œ3æ—¥å‰ã‚ˆã‚Šæ¹¿æ€§å’³å—½ãŒå‡ºç¾ã—ã€2æ—¥å‰ã‚ˆã‚ŠåŠ´ä½œæ™‚å‘¼å¸å›°é›£ã‚’èªã‚ã¾ã—ãŸã€‚æ˜¨æ—¥ã‚ˆã‚Šç™ºç†±ã€é£Ÿæ€ä¸æŒ¯ã€ä½“å‹•å›°é›£ã¨ãªã‚Šå—è¨ºã€‚èµ·åå‘¼å¸ã€å†·æ±—ã€ä¸‹è‚¢æµ®è…«ãªã©ã¯èªã‚ã¾ã›ã‚“ã€‚ç³–å°¿ç—…ã®è‡ªå·±ç®¡ç†ã¯è‰¯å¥½ã§ã—ãŸã€‚ã€",
          tips: ["é£Ÿæ€ä¸æŒ¯ãƒ»ä½“å‹•å›°é›£ã®æç¤ºã¯ã€é‡ç—‡åº¦ãƒ»å…¥é™¢é©å¿œã€ã€‚", "å¿ƒä¸å…¨ã‚’å¦å®šã™ã‚‹ãŸã‚ã®é™°æ€§æ‰€è¦‹ï¼ˆèµ·åå‘¼å¸ãªã—ç­‰ï¼‰ã‚’å«ã‚ãŸã€‚"],
          key: "final_workbook_step_2"
        },
        {
          label: "Step 3", title: "æ—¢å¾€æ­´ãƒ»ä½µå­˜ç—‡", time: "30s",
          rule: "ä»Šå›ã®é‘‘åˆ¥ã«é–¢é€£ã™ã‚‹ã‚‚ã®ã‚’å„ªå…ˆã€‚ã‚«ãƒ«ãƒ†ã«ã¯å…¨ã¦è¨˜è¼‰ã™ã‚‹ãŒã€ãƒ—ãƒ¬ã‚¼ãƒ³ã§ã¯æƒ…å ±ã®å–æ¨é¸æŠã‚’è¡Œã†ã€‚è–¬å‰¤æ­´ã€ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ã‚‚å«ã‚ã‚‹ã€‚",
          example: "ã€Œä½µå­˜ç—‡ã«2å‹ç³–å°¿ç—…ï¼ˆç½¹ç—…æœŸé–“10å¹´ï¼‰ã€é«˜è¡€åœ§ãŒã‚ã‚Šã¾ã™ã€‚å†…æœã¯ãƒ¡ãƒˆãƒ›ãƒ«ãƒŸãƒ³ã€ãƒ€ãƒ‘ã‚°ãƒªãƒ•ãƒ­ã‚¸ãƒ³ã€ã‚¢ãƒ ãƒ­ã‚¸ãƒ”ãƒ³ã€‚è–¬å‰¤ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã€",
          tips: ["ãƒ¡ãƒˆãƒ›ãƒ«ãƒŸãƒ³ã¨SGLT2é˜»å®³è–¬ï¼ˆãƒ€ãƒ‘ã‚°ãƒªãƒ•ãƒ­ã‚¸ãƒ³ï¼‰ã¯ã€æ€¥æ€§æœŸã‚„sick dayã«ã¯ä¸­æ­¢ãƒ»ã‚¤ãƒ³ã‚¹ãƒªãƒ³åˆ‡ã‚Šæ›¿ãˆã®æ¤œè¨ãŒå¿…è¦ãªè–¬å‰¤ã§ã™ã€‚"],
          key: "final_workbook_step_3"
        },
        {
          label: "Step 4", title: "ç”Ÿæ´»æ­´ (Social History)", time: "30s",
          rule: "å‘¼å¸å™¨ç–¾æ‚£ã§ã¯ç‰¹ã«é‡è¦ã€‚å–«ç…™æ­´ï¼ˆBrinkman Index + ç¾å–«ç…™çŠ¶æ³ï¼‰ã€è·æ¥­ã€ãƒšãƒƒãƒˆã€ä½ç’°å¢ƒãªã©ã€‚",
          example: "ã€Œå–«ç…™æ­´ã¯1æ—¥20æœ¬Ã—55å¹´ã€ç¾å–«ç…™è€…ã€‚è·æ­´ã¯äº‹å‹™è·ã€‚ç²‰å¡µæš´éœ²æ­´ã‚„é³¥é¡ã®é£¼è‚²æ­´ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã€",
          tips: ["COPDã‚’ç–‘ã†å ´åˆã€å–«ç…™è€…ã§ã‚ã‚‹ã“ã¨ã€ã‚’æ˜è¨˜ã™ã‚‹ã®ãŒé‡è¦ã§ã™ã€‚"],
          key: "final_workbook_step_4"
        },
        {
          label: "Step 5", title: "èº«ä½“æ‰€è¦‹ (Objective)", time: "1:00",
          rule: "ãƒã‚¤ã‚¿ãƒ«ã¨å…¨èº«çŠ¶æ…‹ã‹ã‚‰é–‹å§‹ã€‚é‘‘åˆ¥ã«é–¢ä¿‚ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ï¼ˆå‘¼å¸å™¨ãƒ»å¾ªç’°å™¨ï¼‰ã‚’ä¸­å¿ƒã«ã€‚å‘¼å¸æ•°ã¯å¤§åˆ‡ã€‚ã¾ãŸã€æ­£å¸¸ã§ã‚ã‚‹ã“ã¨ã‚’æœŸå¾…ã™ã‚‹ã€é™°æ€§æ‰€è¦‹ã€ã‚‚ç¤ºã™ã€‚",
          example: "ã€ŒBP 140/85, HR 95, BT 38.2, RR 24, SpO2 88%(RA)ã€‚è»½åº¦è‹¦æ‚¶æ§˜ã€‚ä¸¡è‚ºé‡ã«wheezesã‚’è´å–ã€‚JVPæ€’å¼µãªã—ã€ä¸‹è‚¢æµ®è…«ãªã—ã€‚ã€",
          tips: ["wheezesã®å­˜åœ¨ã‚’å¼·èª¿ã€‚", "å¿ƒä¸å…¨ã‚’å¦å®šã™ã‚‹é™°æ€§æ‰€è¦‹ï¼ˆJVPãƒ»æµ®è…«ãªã—ï¼‰ã‚’æ˜è¨€ã—ã€å‘¼å¸å™¨ç–¾æ‚£ã®å¯èƒ½æ€§ã‚’è€ƒæ…®ã«å…¥ã‚Œã¾ã™ã€‚"],
          key: "final_workbook_step_5"
        },
        {
          label: "Step 6", title: "æ¤œæŸ»æ‰€è¦‹ (Labs/Imaging)", time: "1:00",
          rule: "ç•°å¸¸å€¤ã‚’ä¸»ã«ç¤ºã™ã€‚ç”»åƒã¯ã€ã©ã“ã«ä½•ãŒã‚ã‚‹ã‹ã€ã‚’è¨€èªåŒ–ã€‚D-dimer/BNPé™°æ€§ãªã©ã€è‡¨åºŠæ¨è«–ã®ãã£ã‹ã‘ã¨ãªã‚‹æ‰€è¦‹ã‚’å‡ºã™ã€‚",
          example: "ã€ŒXç·šã§éè†¨å¼µã‚’èªã‚ã¾ã™ãŒæµ¸æ½¤å½±ãªã—ã€‚CTã§æ°—è…«æ€§å¤‰åŒ–ã¨æ°—ç®¡æ”¯å£è‚¥åšã‚’èªã‚ã¾ã™ã€‚PaO2ä½ä¸‹ã€PaCO2 48mmHgã€WBC11000ã€CRPã¯8ã¨ä¸Šæ˜‡ã€‚D-dimerãŠã‚ˆã³BNPã¯æ­£å¸¸ç¯„å›²å†…ã§ã™ã€‚ã€",
          tips: ["BNP/D-dimerãŒæ­£å¸¸ã§ã‚ã‚‹ã“ã¨ã¯ã€ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆã§å¿ƒä¸å…¨/PEã‚’è«–ç†çš„ã«å¦å®šã™ã‚‹ãŸã‚ã®å¼·åŠ›ãªè¨¼æ‹ ã§ã™ã€‚"],
          key: "final_workbook_step_6"
        },
        {
          label: "Step 7", title: "ãƒ—ãƒ­ãƒ–ãƒ¬ãƒ ãƒªã‚¹ãƒˆ", time: "30s",
          rule: "ç¢ºå®šã—ã¦ã„ãªã„è¨ºæ–­åã¯æ›¸ã‹ãšã€ç—‡å€™åã§è¨˜è¼‰ã€‚ä¸»è¨´ã«é–¢é€£ã™ã‚‹é …ç›®ã‚’ #1 ã«æŒ™ã’ã‚‹ã€‚",
          example: "ã€Œ#1. wheezesã‚’ä¼´ã†IIå‹æ€¥æ€§å‘¼å¸ä¸å…¨ã€#2. 2å‹ç³–å°¿ç—…ã€#3. å–«ç…™æ­´ ã§ã™ã€‚ã€",
          tips: ["æœªè¨ºæ–­ã®æ®µéšã§ #1 COPDæ€¥æ€§å¢—æ‚ª ã¨æ›¸ã‹ãªã„ã€‚"],
          key: "final_workbook_step_7"
        },
        {
          label: "Step 8", title: "ã‚¢ã‚»ã‚¹ãƒ¡ãƒ³ãƒˆ", time: "2:00",
          rule: "Summary Statementã‹ã‚‰é–‹å§‹ã€‚æœ€ã‚‚å¯èƒ½æ€§ã®é«˜ã„è¨ºæ–­ã®æ ¹æ‹ ã€æ¬¡ã„ã§é‘‘åˆ¥ï¼ˆé™¤å¤–ã—ãŸç†ç”±ï¼‰ã‚’è¿°ã¹ã‚‹ã€‚",
          example: "ã€Œå–«ç…™æ­´ã€æ°—è…«æ€§å¤‰åŒ–ã€wheezesã‹ã‚‰ã€èƒŒæ™¯ã«COPDãŒå­˜åœ¨ã—ã€æ„ŸæŸ“ã«ã‚ˆã‚‹æ€¥æ€§å¢—æ‚ªï¼ˆAE-COPDï¼‰ã‚’ç¬¬ä¸€ã«è€ƒãˆã¾ã™ã€‚å¿ƒä¸å…¨ã‚„è‚ºå¡æ “ç—‡ã¯å¦å®šçš„ã§ã™ã€‚#2 ã«ã¤ã„ã¦ã¯ã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰ä½¿ç”¨ã«ã‚ˆã‚‹é«˜è¡€ç³–å¢—æ‚ªãƒªã‚¹ã‚¯ã‚’è€ƒæ…®ã—ã¾ã™ã€‚ã€",
          tips: ["ã€ã€œã¨è€ƒãˆã¾ã™ã€ã¨æ–­å®šçš„ã«è¿°ã¹ã‚‹ã€‚", "ä½µå­˜ç—‡ï¼ˆç³–å°¿ç—…ï¼‰ã¸ã®é…æ…®ã‚’å«ã‚ã‚‹ã“ã¨ã§ã€è‡¨åºŠåŒ»ã¨ã—ã¦ã®è¦–ç‚¹ã®åºƒã•ã‚’ç¤ºã›ã¾ã™ã€‚"],
          key: "final_workbook_step_8"
        },
        {
          label: "Step 9", title: "ãƒ—ãƒ©ãƒ³", time: "30s",
          rule: "è¨ºæ–­ãƒ»æ²»ç™‚ãƒ»æ•™è‚²ãƒ—ãƒ©ãƒ³ã‚’å…·ä½“çš„ã«ã€‚ç‰¹ã«ç³–å°¿ç—…è–¬ã®å…·ä½“çš„èª¿æ•´ï¼ˆä¸­æ­¢è–¬ãƒ»ä»£æ›¿ç™‚æ³•ï¼‰ã‚’æ˜è¨˜ã™ã‚‹ã€‚",
          example: "ã€ŒSpO2 88-92%ç›®æ¨™ã§é…¸ç´ æŠ•ä¸ã€‚å–€ç—°æ¤œæŸ»æå‡ºå¾Œã«ABCç™‚æ³•ï¼ˆæŠ—èŒè–¬ã¯ã‚»ãƒ•ãƒˆãƒªã‚¢ã‚­ã‚½ãƒ³2g/dayãƒ»SAå¸å…¥ãƒ»ã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰ã¯ã‚½ãƒ«ãƒ»ãƒ¡ãƒ‰ãƒ­ãƒ¼ãƒ«40mgx3/dayï¼‰é–‹å§‹ã—ç—…æ…‹ãŒå®‰å®šã™ã‚Œã°LABA/LAMAå¸å…¥è–¬ã®å°å…¥ã‚’æ¤œè¨ã—ã¾ã™ã€‚#2 ã¯ãƒ¡ãƒˆãƒ›ãƒ«ãƒŸãƒ³ãƒ»ãƒ€ãƒ‘ã‚°ãƒªãƒ•ãƒ­ã‚¸ãƒ³ã‚’ä¸­æ­¢ã—ã€ã‚¹ãƒ©ã‚¤ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ã‚±ãƒ¼ãƒ«å¯¾å¿œã¨ã—ã€çµŒå£æ‘‚å–ãŒå®‰å®šã™ã‚Œã°çµŒå£è–¬ã«å¤‰æ›´äºˆå®šã€‚ç¦ç…™æŒ‡å°ã¨é€€é™¢å‰ã«å¿…è¦ãªãƒ¯ã‚¯ãƒãƒ³æ¥ç¨®ã«ã¤ã„ã¦èª¬æ˜ã‚’è¡Œã„ã¾ã™ã€‚ã€",
          tips: ["SGLT2é˜»å®³è–¬ã®ä¸­æ­¢ã¯ã‚·ãƒƒã‚¯ãƒ‡ã‚¤äºˆé˜²ã«é‡è¦ã€‚", "ç¦ç…™ã‚„ãƒ¯ã‚¯ãƒãƒ³ç­‰ã®äºˆé˜²çš„ä»‹å…¥ã‚’å«ã‚ã‚‹ã®ãŒå²¸æœ¬ãƒ¡ã‚½ãƒƒãƒ‰ã€‚"],
          key: "final_workbook_step_9"
        }
      ],
      daily: [
        {
          label: "Step 1", title: "Summary Update", time: "15s",
          rule: "ç¾åœ¨ã®å…¨ä½“åƒã‚’ä¸€è¨€ã§å…±æœ‰ã™ã‚‹ã€‚åå‰ã€ä¸»ç—…åã€ãã—ã¦ã€å…¥é™¢ä½•æ—¥ç›®ã‹ã€ã‚’å¿…ãšå«ã‚ã‚‹ã€‚",
          example: "ã€ŒCOPDæ€¥æ€§å¢—æ‚ªã®ç–‘ã„ã§å…¥é™¢3æ—¥ç›®ã®77æ­³ç”·æ€§ã€ä½è—¤ã•ã‚“ã§ã™ã€‚ABCç™‚æ³•ã¨ã—ã¦ã€ã‚»ãƒ•ãƒˆãƒªã‚¢ã‚­ã‚½ãƒ³2gã€mPSL40mgx3ã€ãƒ™ãƒãƒˆãƒªãƒ³å¸å…¥ã€ä½æµé‡é…¸ç´ ã‚’é–‹å§‹ã—ã¦ã€ç¾åœ¨å‘¼å¸çŠ¶æ…‹ã¯å®‰å®šã—ã¦ã„ã¾ã™ã€‚ã€",
          tips: ["æ—¢å¾€æ­´ç­‰ã¯åˆæ—¥ã«è©±ã—ã¦ã„ã‚‹ã®ã§ã€ã“ã“ã§ã¯ã€ç¾åœ¨ã®ä¸»ç—…åã€ã«çµã‚Šã¾ã™ã€‚"],
          key: "ap_snap_step_1"
        },
        {
          label: "Step 2", title: "Subjective / Objective", time: "30s",
          rule: "æ˜¨æ—¥ã®ãƒ—ãƒ¬ã‚¼ãƒ³ä»¥é™ã®ã€å¤‰åŒ–ã€ã‚’è¿°ã¹ã‚‹ã€‚å¤œé–“ã‚¤ãƒ™ãƒ³ãƒˆã€ãƒã‚¤ã‚¿ãƒ«ã€æ–°è¦æ¤œæŸ»çµæœã®è§£é‡ˆã‚’æç¤ºã€‚",
          example: "ã€Œæ˜¨å¤œã¯å’³å—½ã€å‘¼å¸å›°é›£ãŒè»½æ¸›ã—å…¥çœ ã§ãã¾ã—ãŸã€‚ä»Šæœã‚ˆã‚Šå–€ç—°ã®ç²˜ç¨ åº¦ãŒä½ä¸‹ã—ã€å‘¼å¸å›°é›£æ„Ÿã‚‚æ¶ˆå¤±ã—ã¾ã—ãŸã€‚SpO2 92% (0.5L)ã¨å®‰å®šã€‚è¡€æ¶²æ¤œæŸ»ã§WBC 8500, CRP 2.4ã¨ç‚ç—‡åå¿œã‚‚æ”¹å–„å‚¾å‘ã€‚å–€ç—°ã®GramæŸ“è‰²ã§ã¯ã‚¤ãƒ³ãƒ•ãƒ«ã‚¨ãƒ³ã‚¶æ¡¿èŒã¨æ€ã‚ã‚Œã‚‹ã‚°ãƒ©ãƒ é™°æ€§æ¡¿èŒãŒã¿ã‚‰ã‚Œã¾ã—ãŸã€‚è¡€ç³–ã¯180ã€œ210ã§æ¨ç§»ã€‚ã€",
          tips: ["ã€æ­£å¸¸ç¯„å›²ã€ã¨ã ã‘è¨€ã‚ãšã€ç‚ç—‡æ‰€è¦‹ã®å…·ä½“çš„ãªä½ä¸‹ãªã©ã®ãƒˆãƒ¬ãƒ³ãƒ‰ã‚’è¨€è‘‰ã«ã—ã¾ã™ã€‚"],
          key: "ap_snap_step_2"
        },
        {
          label: "Step 3", title: "Problem #1: A & P", time: "45s",
          rule: "æœ€é‡è¦ãƒ—ãƒ­ãƒ–ãƒ¬ãƒ ã«å¯¾ã™ã‚‹ç¾çŠ¶è©•ä¾¡ã¨ã€ä»Šæ—¥ã®å…·ä½“çš„ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆå‡¦æ–¹å¤‰æ›´ã€é›¢åºŠç­‰ï¼‰ã‚’è¿°ã¹ã‚‹ã€‚",
          example: "ã€Œ#1 AE-COPDã¯ã€å„ç¨®æ‰€è¦‹ã‚ˆã‚Šæ”¹å–„å‚¾å‘ã¨åˆ¤æ–­ã—ã¾ã™ã€‚æœ¬æ—¥ã‚ˆã‚Šé…¸ç´ ã‚’ã‚ªãƒ•ã—ã€æŠ—èŒè–¬ã‚’CTRXã‹ã‚‰æ„Ÿå—æ€§ãŒç¢ºèªã§ãã‚Œã°AMPC/CVAã®å†…æœã«åˆ‡ã‚Šæ›¿ãˆã¾ã™ã€‚åˆå¾Œã«ç†å­¦ç™‚æ³•å£«ã¨é›¢åºŠç¯„å›²ã‚’æ‹¡å¤§ã—ã¾ã™ã€‚ã€",
          tips: ["ã€æ”¹å–„å‚¾å‘ãªã®ã§ç¶™ç¶šã€ã§çµ‚ã‚ã‚‰ãšã€å…·ä½“çš„ãªã€å‰é€²ï¼ˆã‚¹ãƒ†ãƒƒãƒ—ã‚¢ãƒƒãƒ—/ãƒ€ã‚¦ãƒ³ï¼‰ã€ã‚’ææ¡ˆã—ã¦ãã ã•ã„ã€‚"],
          key: "ap_snap_step_3"
        },
        {
          label: "Step 4", title: "Problem #2: A & P", time: "30s",
          rule: "ä½µå­˜ç—‡ã‚„å…¥é™¢ä¸­ã«ç™ºç”Ÿã—ãŸå•é¡Œï¼ˆå‰¯ä½œç”¨ç­‰ï¼‰ã¸ã®è©•ä¾¡ã¨ãƒ—ãƒ©ãƒ³ã‚’è¿°ã¹ã‚‹ã€‚",
          example: "ã€Œ#2 2å‹ç³–å°¿ç—…ã¯ã€ã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰ã«ã‚ˆã‚‹é«˜è¡€ç³–ã‚’èªã‚ã‚‹ã‚‚ã®ã®ã‚¹ãƒ©ã‚¤ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ã‚±ãƒ¼ãƒ«ã§ç®¡ç†å¯èƒ½ã§ã™ã€‚ã‚¹ãƒ©ã‚¤ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ã‚±ãƒ¼ãƒ«ã‚’ç¶™ç¶šã—ã€é£Ÿäº‹æ‘‚å–ãŒå®‰å®šã™ã‚Œã°å†…æœå†é–‹ã‚’æ¤œè¨ã—ã¾ã™ã€‚ã€",
          tips: ["ä¸»ç—…åã®å½±ã«éš ã‚ŒãŒã¡ãªã€ä½µå­˜ç—‡ã€ã®ç®¡ç†çŠ¶æ³ã‚’å ±å‘Šã™ã‚‹ã“ã¨ã§ã€ãƒãƒ¼ãƒ ã®å®‰å¿ƒæ„ŸãŒé«˜ã¾ã‚Šã¾ã™ã€‚"],
          key: "ap_snap_step_4"
        },
        {
          label: "Step 5", title: "Social / Discharge", time: "15s",
          rule: "é€€é™¢ã«å‘ã‘ãŸèª²é¡Œã‚„ã€å®¶æ—ã¸ã®èª¬æ˜äºˆå®šãªã©ã‚’å…±æœ‰ã—ã¦ç· ã‚ããã‚‹ã€‚",
          example: "ã€Œç—…çŠ¶ã¯é †èª¿ã§ã‚ã‚Šã€é€±æœ«ã®é€€é™¢ã‚’ç›®æŒ‡ã—ã¾ã™ã€‚æœ¬æ—¥ã€ã”å®¶æ—ã«ä»Šå¾Œã®å¸å…¥æŒ‡å°ã¨å„ç¨®ãƒ¯ã‚¯ãƒãƒ³æ¥ç¨®ã€é€€é™¢å¾Œã®ç”Ÿæ´»ã«ã¤ã„ã¦èª¬æ˜ã™ã‚‹äºˆå®šã§ã™ã€‚ã€",
          tips: ["åŒ»å­¦çš„å´é¢ã ã‘ã§ãªãã€ã‚±ã‚¢ã®ã€å‡ºå£ã€ã‚’ç¤ºã™ã“ã¨ã§ã€ãƒ—ãƒ¬ã‚¼ãƒ³ãŒå®Œçµã—ã¾ã™ã€‚"],
          key: "ap_snap_step_5"
        }
      ]
    };

    var currentMode = '';
    var steps = [];
    var currentIdx = 0;

    function init() {
      showPortal();
    }

    function showPortal() {
      document.getElementById('portal-view').style.display = 'block';
      document.getElementById('app-view').style.display = 'none';
      document.body.className = '';
    }

    function startApp(mode) {
      currentMode = mode;
      steps = datasets[mode];
      currentIdx = 0;

      document.getElementById('portal-view').style.display = 'none';
      document.getElementById('app-view').style.display = 'flex';
      document.body.className = 'theme-' + mode;

      var inputCard = document.getElementById('input-card');
      var dots = document.getElementById('nav-dots');
      var downloadBtn = document.getElementById('header-btn-download');

      if (mode === 'model') {
        document.getElementById('app-badge').innerHTML = 'Model';
        document.getElementById('app-title').innerHTML = 'ãƒ¢ãƒ‡ãƒ«åŸç¨¿';
        inputCard.style.display = 'none';
        dots.style.display = 'none';
        downloadBtn.style.display = 'none';
      } else {
        if (mode === 'case') {
          document.getElementById('app-badge').innerHTML = 'H&P';
          document.getElementById('app-title').innerHTML = 'ç—‡ä¾‹ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ»ãƒ¯ãƒ¼ã‚¯ãƒ–ãƒƒã‚¯';
          document.getElementById('right-header-text').innerHTML = 'Your Draft';
        } else if (mode === 'daily') {
          document.getElementById('app-badge').innerHTML = 'P-A/P';
          document.getElementById('app-title').innerHTML = 'ãƒ—ãƒ­ãƒ–ãƒ¬ãƒ åˆ¥ãƒ‡ã‚¤ãƒªãƒ¼ãƒ¯ãƒ¼ã‚¯ãƒ–ãƒƒã‚¯';
          document.getElementById('right-header-text').innerHTML = 'Active Problem Draft';
        }
        inputCard.style.display = 'flex';
        dots.style.display = 'flex';
        downloadBtn.style.display = 'inline-block';
      }

      renderNav();
      updateUI();
    }

    function renderNav() {
      var nav = document.getElementById('nav-dots');
      nav.innerHTML = '';
      if (currentMode === 'model') return;

      for (var i = 0; i < steps.length; i++) {
        var span = document.createElement('span');
        span.className = 'dot' + (i === currentIdx ? ' active' : '');
        span.innerHTML = (i + 1);
        span.onclick = (function (index) {
          return function () { currentIdx = index; updateUI(); };
        })(i);
        nav.appendChild(span);
      }
    }

    function updateUI() {
      var dots = document.getElementById('nav-dots');

      if (currentMode === 'model') {
        var html = '<div style="background:white; border:1px solid #e2e8f0; border-radius:12px; overflow:hidden; margin-bottom:20px;">' +
          '<div style="background:#fffbeb; padding:24px; border-bottom:1px solid #fde68a;">' +
          '<div style="display:flex; justify-content:space-between; margin-bottom:8px;"><span style="color:#d97706; font-size:12px; font-weight:bold; letter-spacing:1px; text-transform:uppercase;">Case Study</span><span style="color:#94a3b8; font-family:monospace; font-size:12px;">ID: 001</span></div>' +
          '<h2 style="font-size:24px; font-weight:bold; margin:0 0 8px 0; color:#0f172a;">77æ­³ç”·æ€§ å‘¼å¸å›°é›£ã¨æ¹¿æ€§å’³å—½</h2>' +
          '<div style="font-size:14px; color:#64748b;">ä¸»è¨´ï¼šå‘¼å¸å›°é›£ã€æ¹¿æ€§å’³å—½ / è¨ºæ–­ï¼šCOPDæ€¥æ€§å¢—æ‚ª</div>' +
          '</div><div style="padding:40px;">';

        for (var i = 0; i < steps.length; i++) {
          var s = steps[i];
          html += '<div style="margin-bottom:32px;">';
          html += '<div style="margin-bottom:8px; display:flex; align-items:center; gap:8px;"><span style="background:#e2e8f0; color:#475569; font-size:10px; font-weight:bold; padding:2px 6px; border-radius:4px; text-transform:uppercase;">' + s.label + '</span><h3 style="font-size:14px; font-weight:bold; color:#94a3b8; letter-spacing:1px; text-transform:uppercase; margin:0;">' + s.title + '</h3></div>';
          html += '<p style="border-left:4px solid #fde68a; padding-left:16px; font-size:18px; line-height:1.6; color:#1e293b; white-space:pre-wrap; margin:0;">' + (s.example || '').replace(/\n/g, '<br>') + '</p>';
          html += '</div>';
        }
        html += '</div></div>';

        document.getElementById('step-header-card') && (document.getElementById('step-header-card').style.display = 'none');
        document.getElementById('step-label').parentNode.parentNode.style.display = 'none'; // hide step-header-card
        document.getElementById('example-container').style.display = 'none';

        var container = document.getElementById('full-model-view');
        container.innerHTML = html;
        container.style.display = 'block';

      } else {
        var headerCard = document.getElementsByClassName('step-header-card')[0];
        if (headerCard) headerCard.style.display = 'block';

        document.getElementById('example-container').style.display = 'flex';
        document.getElementById('full-model-view').style.display = 'none';

        var s = steps[currentIdx];
        document.getElementById('step-label').innerHTML = s.label || '';
        document.getElementById('step-time').innerHTML = s.time || "";
        document.getElementById('step-title').innerHTML = s.title || '';
        document.getElementById('step-rule').innerHTML = s.rule || '';
        document.getElementById('step-example').innerHTML = (s.example || '').replace(/\n/g, '<br>');

        var tipsHtml = '';
        if (s.tips) {
          for (var i = 0; i < s.tips.length; i++) {
            tipsHtml += '<div class="tip-item"><span>â€¢</span><div>' + s.tips[i] + '</div></div>';
          }
        }
        document.getElementById('step-tips').innerHTML = tipsHtml;

        var val = window.localStorage.getItem(s.key) || "";
        document.getElementById('draft-input').value = val;
        document.getElementById('char-count').innerHTML = val.length + ' CHARS';

        document.getElementById('btn-prev').disabled = (currentIdx === 0);
        document.getElementById('btn-next').innerHTML = (currentIdx === steps.length - 1 ? 'FINISH' : 'NEXT â†’');

        var dotsArr = dots.getElementsByTagName('span');
        for (var j = 0; j < dotsArr.length; j++) {
          dotsArr[j].className = 'dot' + (j === currentIdx ? ' active' : '');
        }
      }
    }

    function nextStep() {
      if (currentIdx < steps.length - 1) {
        currentIdx++;
        updateUI();
      }
    }

    function prevStep() {
      if (currentIdx > 0) {
        currentIdx--;
        updateUI();
      }
    }

    function saveDraft() {
      var val = document.getElementById('draft-input').value;
      window.localStorage.setItem(steps[currentIdx].key, val);
      document.getElementById('char-count').innerHTML = val.length + ' CHARS';
    }

    function downloadAll() {
      var titleMap = { 'case': 'ç—‡ä¾‹ãƒ—ãƒ¬ã‚¼ãƒ³', 'daily': 'ãƒ—ãƒ­ãƒ–ãƒ¬ãƒ åˆ¥ãƒ‡ã‚¤ãƒªãƒ¼' };
      var text = "ã€" + (titleMap[currentMode] || "Presentation Workbook") + "ã€‘\n";
      text += "ä½œæˆæ—¥: " + new Date().toLocaleString() + "\n";
      text += "--------------------------------------\n\n";

      for (var i = 0; i < steps.length; i++) {
        var val = window.localStorage.getItem(steps[i].key) || "(æœªå…¥åŠ›)";
        text += "â–  " + steps[i].label + ": " + steps[i].title + "\n";
        text += val + "\n\n";
      }

      var blob = new Blob([text], { type: "text/plain;charset=utf-8" });

      if (window.navigator && window.navigator.msSaveOrOpenBlob) {
        window.navigator.msSaveOrOpenBlob(blob, "presentation_draft.txt");
      } else {
        var url = URL.createObjectURL(blob);
        var a = document.createElement("a");
        a.href = url;
        a.download = "presentation_draft.txt";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      }
    }

    init();
  </script>

</body>

</html>
